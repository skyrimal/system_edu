<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>教师登录</title>
    <!--
      作者：阳柯吉
      时间：2019-10-01
      描述：主页面分析尝试
  -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="/statics/vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <!--图标 -->
    <link rel="stylesheet" href="/statics/vendor/font-awesome/css/font-awesome.min.css">
    <!-- Fontastic Custom icon font-->
    <!--在线创建自己的图标字体，免费享用图标字体云服务-->
    <link rel="stylesheet" href="/statics/css/fontastic.css">
    <!-- Google fonts - Poppins -->
    <!--提供了超过 800 种的高质量的字体,所有的浏览器都兼容-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,700">
    <!-- theme stylesheet-->
    <!--主题样式-->
    <link rel="stylesheet" href="/statics/css/style.sea.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <!--css样式修改用-->
    <link rel="stylesheet" href="/statics/css/custom.css">
    <!-- Favicon-->
    <!--网页图标-->
    <link rel="shortcut icon" href="/statics/img/favicon.ico">
    <!-- Tweaks for older IEs-->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
</head>

<body>
<div class="modal fade" id="stusubmit_context" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true"
     data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content" style="width: 1000px">
            <div class="modal-header">
                批阅作业
                <p id="msg" class="bg-info"></p>
            </div>
            <div class="modal-body">
                <p id="context_"></p>
                    <input id="hiddenSubmitCode" type="text" name="submitCode" value="" hidden="hidden"/>
                    <input id="finalScore" type="number" name="finalScore" value="" placeholder="输入作业得分"/>
                <button class="btn-info" onclick="clickc()">提交</button>
                <a id="downFile" href="" class="btn btn-outline-info">下载作业附件</a>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" data-toggle="modal"
                        data-target="#searchsubmit">关闭
                </button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>

<!--发布作业-->
<!-- 模态框（Modal） -->
<div class="modal fade" id="made_tesk" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
     data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">发布第五周作业</h4>
            </div>
            <div class="modal-body">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <!--表单-->

                            <form class="form-horizontal">
                                <div class="form-group row">
                                    <label class="col-sm-3 form-control-label">作业标题</label>
                                    <div class="col-sm-9">
                                        <input type="text" disabled="" class="form-control" name="title"
                                               placeholder="标题在100字以内">
                                    </div>
                                </div>
                                <div class="line"></div>
                                <div class="form-group row">
                                    <label class="col-sm-3 form-control-label">作业简介</label>
                                    <div class="col-sm-9">
                                        <textarea class="form-control" rows="3" name="tip"
                                                  placeholder="简介内容在1000字以内"></textarea>
                                    </div>
                                </div>
                                <div class="line"></div>
                                <div class="form-group row">
                                    <label class="col-sm-3 form-control-label">助教批阅作业 <br><small class="text-primary">选择是助教可以给本次作业评分</small></label>
                                    <div class="col-sm-9">
                                        <div>
                                            <input id="optionsRadios1" type="radio" value="true" name="judgement1">
                                            <label for="optionsRadios1">是</label>
                                        </div>
                                        <div>
                                            <input id="optionsRadios2" type="radio" checked="true" value="true"
                                                   name="judgement1">
                                            <label for="optionsRadios2">否</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-sm-3 form-control-label">小组作业 <br><small class="text-primary">选择是同一小组只提交一份作业</small></label>
                                    <div class="col-sm-9">
                                        <div>
                                            <input id="optionsRadios3" type="radio" value="true" name="judgement2">
                                            <label for="optionsRadios3">是</label>
                                        </div>
                                        <div>
                                            <input id="optionsRadios4" type="radio" checked="true" value="true"
                                                   name="judgement2">
                                            <label for="optionsRadios4">否</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="line"></div>
                                <div class="form-group row">
                                    <label class="col-sm-3 form-control-label">设置作业分数</label>
                                    <div class="col-sm-9">
                                        <select name="count" class="form-control mb-3">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="line"></div>
                                <div class="form-group row">
                                    <label for="fileInput" class="col-sm-3 form-control-label">上传相关附件</label>
                                    <div class="col-sm-9">
                                        <input id="fileInput" type="file" class="form-control-file">
                                    </div>
                                </div>
                                <div class="line"></div>
                                <div class="form-group row">
                                    <div class="col-sm-4 offset-sm-3">
                                        <button type="submit" class="btn btn-primary">提交</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>

<div class="modal fade" id="searchsubmit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
     data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" style="width: 1000px">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="as">批阅作业</h4>
            </div>
            <div class="modal-body">
                <table class="table table-striped table-sm">
                    <thead>
                    <tr>
                        <th>学生名</th>
                        <th>学号</th>
                        <th>上传时间</th>
                        <th>作业状态</th>
                        <th>最终得分</th>
                        <th>修改</th>
                    </tr>
                    </thead>
                    <tbody id="SaaS">
                    <tr class="">
                        <th scope="row">0001</th>
                        <td>数据结构</td>
                        <td>2019年10月13日 12:51</td>
                        <td>2019年10月14日 23:55</td>
                        <td>web应用开发中的SSM.......</td>
                        <td>
                            <div class="btn-group-sm">
                                <div class="btn btn-warning btn-sm" data-toggle="modal" data-target="#searchsubmit">批阅
                                </div>
                                <div id="check_stusubmit_context" class="btn btn-warning btn-sm" data-toggle="modal"
                                     data-target="#stusubmit_context" onclick="">查看
                                </div>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>


<div class="page">
    <!-- 主菜单栏-->

    <div th:insert="~{/bar/head_bar::header}"></div>
    <div class="page-content d-flex align-items-stretch">
        <div th:insert="~{/bar/left_bar::t_side-navbar}"></div>
        <!-- 页面主体 -->
        <div class="content-inner">
            <!-- 页面主体标签 -->
            <header class="page-header">
                <div class="container-fluid">
                    <h2 class="no-margin-bottom">教学信息</h2>
                </div>
            </header>
            <table class="table table-striped table-sm">
                <thead>
                <tr>
                    <th>班级编号</th>
                    <th>课程名称</th>
                    <th>作业标题</th>
                    <th>发布时间</th>
                    <th>截止时间</th>
                    <th>分数</th>
                    <th>状态</th>
                    <th>修改</th>
                </tr>
                </thead>
                <tbody id="homworkMsg">
                <tr class="">
                    <th scope="row">0001</th>
                    <td>数据结构</td>
                    <td>2019年10月13日 12:51</td>
                    <td>2019年10月14日 23:55</td>
                    <td>web应用开发中的SSM.......</td>
                    <td>7</td>
                    <td>7</td>
                    <td>
                        <div class="btn-group-sm">
                            <div class="btn btn-warning btn-sm" data-toggle="modal" data-target="#made_tesk">修改</div>
                            <div class="btn btn-warning btn-sm" data-toggle="modal" data-target="#searchsubmit">批阅</div>
                            <div class="btn btn-warning btn-sm">查看</div>
                            <div class="btn btn-warning btn-sm">重新开放</div>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
            <!-- 页脚    -->
            <footer class="main-footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-6">
                            <p>2019 计算机科学与技术专业毕业设计
                            </p>
                        </div>
                        <div class="col-sm-6 text-right">
                            <p></p>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
</div>
<!-- JavaScript files-->
<div th:insert="~{/bar/js_bar::js}"></div>
<script src="/statics/js/teacher.js"></script>
<script src="/statics/js/page_helper.js"></script>
<script>
    $(function () {
        $.ajax({
            type: "get",
            url: "/teacher/homework/getHomework",
            success: function (date) {
                console.log(date);
                $("#homworkMsg").children().remove();
                $.each(date, function (index, value) {
                    console.info(index);
                    $("#homworkMsg").append("<tr class=\"\">\n" +
                        "                    <th scope=\"row\">" + value.courseClassCode + "</th>\n" +
                        "                    <td>" + value.courseName + "</td>\n" +
                        "                    <td>" + value.title + "</td>\n" +
                        "                    <td>" + value.startTime + "</td>\n" +
                        "                    <td>" + value.endTime + "</td>\n" +
                        "                    <td>" + value.score + "</td>\n" +
                        "                    <td>" + value.status + "</td>\n" +
                        "                    <td>\n" +
                        "                        <div class=\"btn-group-sm\">\n" +
                        "                            <div class=\"btn btn-warning btn-sm\" data-toggle=\"modal\" data-target=\"#made_tesk\">修改</div>\n" +
                        "                            <div class=\"btn btn-warning btn-sm\" data-toggle=\"modal\" onclick = \"clicka(" + "'" + value.code + "'" + ")\" data-target=\"#searchsubmit\">批阅</div>\n" +
                        "                            <div class=\"btn btn-warning btn-sm\">查看</div>\n" +
                        "                            <div class=\"btn btn-warning btn-sm\">重新开放</div>\n" +
                        "                        </div>\n" +
                        "                    </td>" +
                        "                </tr>");
                })

            }, error: function (XMLHttpRequest, textStatus, errorThrown) {
                // 状态码
                console.log(XMLHttpRequest.status);
                // 状态
                console.log(XMLHttpRequest.readyState);
                // 错误信息
                console.log(textStatus);
            }
        });

    });

    function clicka(a) {
        $.ajax({
            type: "get",
            url: "teacher/correctHomeworkInfo/" + a,
            success(data) {
                $("#SaaS").children().remove();
                console.info(data);
                $.each(data, function (index, value) {

                    console.info(value.finalScore);
                    if (value.finalScore == null){
                        $("#SaaS").append(" <tr class=\"\">\n" +
                            "                        <th scope=\"row\">" + value.stuName + "</th>\n" +
                            "                        <td>" + value.loginCode + "</td>\n" +
                            "                        <td>" + value.updateTime + "</td>\n" +
                            "                        <td>" + value.status + "</td>\n" +
                            "                        <td>" + value.finalScore + "</td>\n" +
                            "                        <td>\n" +
                            "                            <div class=\"btn-group-sm\">\n" +
                            "                                <div class=\"btn btn-warning btn-sm\" data-toggle=\"modal\" data-target=\"#stusubmit_context\" data-dismiss=\"modal\" onclick=\"clickb('" + value.code + "','" + value.context + "','" + value.fileName + "');\">批阅</div>\n" +
                            "                            </div>\n" +
                            "                        </td>\n" +
                            "                    </tr>");
                    }else{
                        $("#SaaS").append(" <tr class=\"\">\n" +
                            "                        <th scope=\"row\">" + value.stuName + "</th>\n" +
                            "                        <td>" + value.loginCode + "</td>\n" +
                            "                        <td>" + value.updateTime + "</td>\n" +
                            "                        <td>" + value.status + "</td>\n" +
                            "                        <td>" + value.finalScore + "</td>\n" +
                            "                        <td>\n" +
                            "                        </td>\n" +
                            "                    </tr>");
                    }

                })
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                // 状态码
                console.log(XMLHttpRequest.status);
                // 状态
                console.log(XMLHttpRequest.readyState);
                // 错误信息
                console.log(textStatus);
            }
        })
    }

    function clickb(code, context, fileName) {
        console.info("点了一下b");
        console.info(context);
        $("#context_").text("").text(context);
        $("#downFile").attr("href", "/download/" + fileName + ".docx");
        $("#hiddenSubmitCode").val("").val(code);
    }

    function clickc() {
        var hiddenSubmitCode = $("#hiddenSubmitCode").val();
        var finalScore = $("#finalScore").val();
        $.ajax({
            type:"get",
            url:"/teacher/homework/correctHomework",
            data:{
                'submitCode':hiddenSubmitCode,
                'finalScore':finalScore
            },
            success(data){
                console.info(data);
                $("#msg").text(data)
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                // 状态码
                console.log(XMLHttpRequest.status);
                // 状态
                console.log(XMLHttpRequest.readyState);
                // 错误信息
                console.log(textStatus);
            }
        })
    }
</script>
</body>

</html>